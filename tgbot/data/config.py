# - *- coding: utf- 8 - *-
import sqlite3
import configparser
import json


read_config = configparser.ConfigParser()
read_config.read('settings.ini')

BOT_TOKEN = read_config['settings']['token'].strip()  # –¢–æ–∫–µ–Ω –±–æ—Ç–∞
PATH_DATABASE = 'tgbot/data/database.db'  # –ü—É—Ç—å –∫ –ë–î
PATH_LOGS = 'tgbot/data/logs.log'  # –ü—É—Ç—å –∫ –õ–æ–≥–∞–º
BOT_VERSION = '1.0'

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –≤ —Å–ª–æ–≤–∞—Ä—å


def dict_factory(cursor, row):
    save_dict = {}

    for idx, col in enumerate(cursor.description):
        save_dict[col[0]] = row[idx]

    return save_dict

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤


def update_format(sql, parameters: dict):
    if "XXX" not in sql:
        sql += " XXX "

    values = ", ".join([
        f"{item} = ?" for item in parameters
    ])
    sql = sql.replace("XXX", values)

    return sql, list(parameters.values())


def get_type_trade():
    get_type_trade = get_settingsx()['type_trade']
    return get_type_trade

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –±–æ—Ç–∞


def get_admins():
    read_admins = configparser.ConfigParser()
    read_admins.read('settings.ini')

    admins = read_admins['settings']['admin_id'].strip()
    admins = admins.replace(' ', '')

    if ',' in admins:
        admins = admins.split(',')
    else:
        if len(admins) >= 1:
            admins = [admins]
        else:
            admins = []

    while '' in admins:
        admins.remove('')
    while ' ' in admins:
        admins.remove(' ')
    while '\r' in admins:
        admins.remove('\r')

    admins = list(map(int, admins))
    # print(admins)
    return admins

    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥–º–∏–Ω–æ–≤ –º–∞–≥–∞–∑–∏–Ω–æ–≤


def get_shopadmins():
    with sqlite3.connect(PATH_DATABASE) as con:
        con.row_factory = dict_factory
        sql = f"SELECT user_id FROM storage_users WHERE user_role='ShopAdmin'"
        allshopadmins = con.execute(sql).fetchall()
        # print(allshopadmins)
        shopadmins = []
        for admin in allshopadmins:
            k = admin['user_id']
            shopadmins.append(k)
        # print(shopadmins)
        # print(type(shopadmins))

    return shopadmins


def get_shopadmins2():
    read_shopadmins = configparser.ConfigParser()
    read_shopadmins.read('settings.ini')

    shopadmins = read_shopadmins['settings']['shopadmin_id'].strip()
    shopadmins = shopadmins.replace(' ', '')

    if ',' in shopadmins:
        shopadmins = shopadmins.split(',')
    else:
        if len(shopadmins) >= 1:
            shopadmins = [shopadmins]
        else:
            shopadmins = []

    while '' in shopadmins:
        shopadmins.remove('')
    while ' ' in shopadmins:
        shopadmins.remove(' ')
    while '\r' in shopadmins:
        shopadmins.remove('\r')

    shopadmins = list(map(int, shopadmins))

    return shopadmins

    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥–º–∏–Ω–æ–≤ –º–∞–≥–∞–∑–∏–Ω–æ–≤


def is_shopadmin(user_id):
    with sqlite3.connect(PATH_DATABASE) as con:
        con.row_factory = dict_factory
        sql = f"SELECT user_id FROM storage_users "
        #sql, parameters = update_format(sql, kwargs)
        # parameters.append(user_id)
        shopadmin = con.execute(
            sql + "WHERE user_id = ?", [user_id]).fetchone()

    return shopadmin['user_id']


def check_adminproducts():
    #get_position = get_positionsx(position_user_id=message.from_user.id)

    return 1


BOT_DESCRIPTION = f"""
 
<b>‚ùóüî¥ –ü—Ä–∞–≤–∏–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</b>
- –ó–∞–ø—Ä–µ—â–µ–Ω–æ –º–µ–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç–∞, –ø—Ä–∏ —ç—Ç–æ–º –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å –¥—Ä—É–∑–µ–π (–¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–± –ø–æ–∏–≥—Ä–∞—Ç—å —Å –Ω–∏–º–∏)
- –ó–∞–ø—Ä–µ—â–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á–∏—Ç—ã –∏ –¥—Ä—É–≥–∏–µ –≤–∏–¥—ã –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞, –∏–≥—Ä–∞–π—Ç–µ —á–µ—Å—Ç–Ω–æ!
- –í—ã –Ω–µ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç —Ç—Ä–µ—Ç—å–µ–º—É –ª–∏—Ü—É. –ï—Å–ª–∏ —ç—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç, —Ç–æ —É –Ω–∞—Å –±—É–¥–µ—Ç –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω –≤—Ö–æ–¥ —Å –¥—Ä—É–≥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. –í—ã –±—É–¥–µ—Ç–µ –¥–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –∏ –ª–∏—à–µ–Ω—ã –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç, –±–µ–∑ –≤–æ–∑–≤—Ä–∞—Ç–∞ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤.
- –ù–∞ –∞–∫–∫–∞—É–Ω—Ç –º–æ–∂–µ—Ç –∑–∞–π—Ç–∏ –Ω–∞—à –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏. –ü—Ä–∏ –ª—é–±—ã—Ö –ø–æ–¥–æ–∑—Ä–µ–Ω–∏—è—Ö, —á—Ç–æ –∞–∫–∫–∞—É–Ω—Ç–æ–º –∫—Ç–æ-—Ç–æ –ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—Ä–æ–º–µ –≤–∞—Å - —Å—Ä–∞–∑—É –∂–µ —Å–æ–æ–±—â–∞–π—Ç–µ –Ω–∞–º, –º—ã –ø—Ä–æ–≤–µ—Ä–∏–º –∏ –¥–µ–∞–≤—Ç–æ—Ä–∏–∑—É–µ–º –ª—é–±—ã–µ —Å–µ—Å—Å–∏–∏, –∫—Ä–æ–º–µ –≤–∞—à–µ–π.
- –ü–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞ –∞—Ä–µ–Ω–¥—ã –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∞–∫–∫–∞—É–Ω—Ç–æ–º –∏ –¥–æ–ª–∂–Ω—ã –≤—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞ –∏–ª–∏ –∂–µ –æ–ø–ª–∞—Ç–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∞—Ä–µ–Ω–¥—ã.

–ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–¥–∏–Ω –∫–æ–º–ø—å—é—Ç–µ—Ä. –í—ã –ø–ª–∞—Ç–∏—Ç–µ –∑–∞ 1 –∞–∫—Ç–∏–≤–∞—Ü–∏—é –Ω–∞ 1 –ü–ö!
‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤–∞—à –∫–æ–º–ø—å—é—Ç–µ—Ä —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∏–≥—Ä—ã!
‚úÖ –ú—ã –Ω–µ –¥–µ–ª–∞–µ–º –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ –µ—Å–ª–∏ –≤–∞—à –ü–ö –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∏–≥—Ä—ã.
‚úÖ –ê–∫–∫–∞—É–Ω—Ç –∫—É–ø–ª–µ–Ω –ª–µ–≥–∞–ª—å–Ω–æ, —è–≤–ª—è–µ—Ç—Å—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é –ø—Ä–æ–¥–∞–≤—Ü–∞ –∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤–∞–º –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å. –ú–µ–Ω—è—Ç—å –ø–∞—Ä–æ–ª—å –ó–ê–ü–†–ï–©–ï–ù–û! –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∞–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞.
‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ
<b>‚öú –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã:</b>
‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ
<b>–ö–∞–∫ –≤–∑—è—Ç—å –∏–≥—Ä—É –≤ –∞—Ä–µ–Ω–¥—É ?</b>
–í –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é –±–æ—Ç–∞ –≤—ã–±–∏—Ä–∞–µ–º - "–ò–≥—Ä—ã –≤ –∞—Ä–µ–Ω–¥—É" => –ò–≥—Ä—É –∫–æ—Ç–æ—Ä—É—é —Ö–æ—Ç–∏—Ç–µ –∞—Ä–µ–Ω–¥–æ–≤–∞—Ç—å => –í—ã–±–∏—Ä–∞–µ—Ç–µ —Å—Ä–æ–∫ –∞—Ä–µ–Ω–¥—ã =>
üí∞ –í–∑—è—Ç—å –≤ –∞—Ä–µ–Ω–¥—É (–ï—Å–ª–∏ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤, –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å –º–æ–∂–Ω–æ –≤ –ø—Ä–æ—Ñ–∏–ª–µ => "üí∞ –ü–æ–ø–æ–ª–Ω–∏—Ç—å")

<b>–ö–∞–∫ —è –ø–æ–ª—É—á—É –∏–≥—Ä—É –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã ?</b>
–ö–∞–∫ —Ç–æ–ª—å–∫–æ –í—ã –æ–ø–ª–∞—Ç–∏—Ç–µ –∞—Ä–µ–Ω–¥—É, –¥–æ—Å—Ç—É–ø—ã –∫ –∞–∫–∫–∞—É–Ω—Ç—É Steam –ø–æ—è–≤—è—Ç—Å—è —Å –í–∞—à–µ–º –ø—Ä–æ—Ñ–∏–ª–µ –≤ —Ä–∞–∑–¥–µ–ª–µ "üéÅ –ú–æ–∏ –ø–æ–∫—É–ø–∫–∏"

<b>–ö–∞–∫ –º–Ω–µ –Ω–∞—á–∞—Ç—å –∏–≥—Ä–∞—Ç—å ?</b>
–í–∞–º –≤—ã–¥–∞—ë—Ç—Å—è –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å –æ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞ —Å –∏–≥—Ä–æ–π –≤ Steam. 
–ü—Ä–æ—Å—Ç–æ –∑–∞—Ö–æ–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç —Å —ç—Ç–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–µ –±—É–¥–µ—Ç –∞—Ä–µ–Ω–¥–æ–≤–∞–Ω–Ω–∞—è –∏–≥—Ä–∞. 
–°—Ä–æ–∫ –∞—Ä–µ–Ω–¥—ã –∏—Å—á–∏—Å–ª—è–µ—Ç—Å—è —Å –º–æ–º–µ–Ω—Ç–∞ –æ–ø–ª–∞—Ç—ã, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç–µ –∏ –∏–≥—Ä–∞–µ—Ç–µ.

<b>–ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏ –≤ Steam, —á—Ç–æ –¥–µ–ª–∞—Ç—å?</b>
–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å–æ –≤—Ö–æ–¥–æ–º, –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞—à–µ–º—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É - "@tech_steam"
–û—Ç–≤–µ—Ç –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –≤ –ø–æ—Ä—è–¥–∫–µ –æ—á–µ—Ä–µ–¥–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è.

<b>–ú–æ–≥—É –ª–∏ —è —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —Å–≤–æ–∏ –∏–≥—Ä—ã –≤ –∞—Ä–µ–Ω–¥—É –≤ –≤–∞—à–µ–º –º–∞–≥–∞–∑–∏–Ω–µ ?</b>
–ü–æ –≤–æ–ø—Ä–æ—Å–∞–º —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞ –ø–∏—à–∏—Ç–µ - @ru_adm

‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ
<b>‚öú –ö–æ–Ω—Ç–∞–∫—Ç—ã:</b>
–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ : @tech_steam
–°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ : @ru_adm
‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ‚ûñ
""".strip()
